<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HotSloths!</title>
    <style>
        html, body, #sloths {
            overflow: hidden;
            width: 100%;
            max-height: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
    <script src="jquery-3.1.1.min.js"></script>
</head>
<body>
<div id="sloths"></div>
<!-- Creator: Daniel Mason
       Twitter: @iDanooNZ
       Comments: After a few casual drinks, a friend of mine suggested a domain.. It was available.. :D
                Also.. I don't really javascript often so excuse the crappy code.
                 ALSO I AM SORRY ABOUT THE ADS :( -->

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="position:absolute; bottom:0; right:0; z-index:9999; display:block; width:320px;height:50px; padding:0!important;margin:0!important;"
     data-ad-client="ca-pub-1912142404509863"
     data-ad-slot="9408954236"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script>
    $(document).ready(function () {
        var slothDom = $('#sloths');
        var delayTime = 4000;

        function checkExtention(url) {
            var parts = url.split('.');
            var ext = parts[parts.length - 1];
            switch (ext.toLowerCase()) {
                case 'png':
                case 'jpg':
                    return true;
            }
            return false;
        }

        function shuffleImages(sloths) {
            var i = sloths.length - 1;
            while (i > 0) {
                var j = parseInt(Math.random() * i);
                var x = sloths[--i];
                sloths[i] = sloths[j];
                sloths[j] = x;
            }
            return sloths;
        }

        function updateImage(image) {
            slothDom.html('<img src="' + image + '" style="width:100%; height:100%; position:absolute; top:0; left: 0;">');
            return true;
        }

        function updateSloths(last) {
            $.getJSON("https://www.reddit.com/r/sloths/.json?count=25&after=" + last, function (data) {
                var i = 1;
                var last = data.data.after;
                var sloths = $.map(data.data.children, function (item) {
                    var url = item.data.url;
                    if (url.indexOf("imgur.com") != -1 && (url.indexOf(".png") == 0 || url.indexOf(".jpg") == 0)) {
                        url = url + ".jpg";
                    }
                    var legitExtention = checkExtention(url);
                    if (legitExtention == false) return;
                    if (url.indexOf("imgur.com/a/") != -1) return;
                    if (url.indexOf("http://imgur.com") != -1 || url.indexOf("http://i.imgur.com") != -1) {
                        url = url.substring(4);
                        url = "https" + url;
                    }
                    return url;
                });
                sloths = shuffleImages(sloths);
                var x = 1;
                var slothCount = sloths.length - 1;

                //Load first image + preload second before loop.
                updateImage(sloths[0]);
                var preload = new Image();
                preload.src = sloths[1];
                var timer = setInterval(function () {
                    updateImage(sloths[x]);
                    if (x == slothCount) {
                        clearInterval(timer);
                        updateSloths(last);
                    } else {
                        var preload = new Image();
                        preload.src = sloths[x + 1];
                    }
                    x++;
                }, delayTime);
            });
        }

        updateSloths("");
    });
</script>
</body>
</html>